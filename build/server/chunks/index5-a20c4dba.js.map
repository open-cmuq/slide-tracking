{"version":3,"file":"index5-a20c4dba.js","sources":["../../../.svelte-kit/adapter-node/chunks/index5.js"],"sourcesContent":["import { p as prisma } from \"./index4.js\";\nasync function project(id) {\n  const project2 = (\n    /** @type {Project} */\n    await prisma.project.findFirst({\n      where: { id }\n    })\n  );\n  return {\n    type: \"project\",\n    ...project2\n  };\n}\nasync function experiment(id) {\n  const experiment2 = (\n    /** @type {Experiment} */\n    await prisma.experiment.findFirst({\n      where: { id }\n    })\n  );\n  return {\n    type: \"experiment\",\n    ...experiment2\n  };\n}\nasync function slide(id) {\n  const slide2 = (\n    /** @type {Slide} */\n    await prisma.slide.findFirst({\n      where: { id }\n    })\n  );\n  return {\n    type: \"slide\",\n    ...slide2\n  };\n}\nasync function coverslip(id) {\n  const [coverslip2] = await prisma.$queryRaw`\n\t\tWITH cte AS (\n\t\t\tSELECT *,\n\t\t\t\trow_number() OVER (\n\t\t\t\t\tPARTITION BY slideId\n\t\t\t\t\tORDER BY createdAt\n\t\t\t\t) AS pos\n\t\t\tFROM Coverslip\n\t\t)\n\t\tSELECT\n\t\t\t*,\n\t\t\t'Coverslip ' || pos as title,\n\t\t\t'coverslip' AS type\n\t\tFROM cte\n\t\tWHERE id = ${id}\n\t\tLIMIT 1\n\t`;\n  return coverslip2;\n}\nasync function findAll(breadcrumbTrail) {\n  const getters = (\n    /** @type {const} */\n    [\n      [\"projectId\", project],\n      [\"experimentId\", experiment],\n      [\"slideId\", slide],\n      [\"coverslipId\", coverslip]\n    ]\n  );\n  const promises = [];\n  for (const [type, get] of getters) {\n    const id = breadcrumbTrail[type];\n    if (id)\n      promises.push(get(id));\n  }\n  const root = {\n    type: \"root\",\n    name: \"own\",\n    title: \"My projects\"\n  };\n  return [root, ...await Promise.all(promises)];\n}\nconst breadcrumbs = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({\n  __proto__: null,\n  coverslip,\n  experiment,\n  findAll,\n  project,\n  slide\n}, Symbol.toStringTag, { value: \"Module\" }));\nasync function includeCreatedBy(items) {\n  const createdByUsers = await prisma.user.findMany({\n    where: {\n      id: {\n        in: items.map(({ createdByUserId }) => createdByUserId)\n      }\n    }\n  });\n  const userMap = new Map(createdByUsers.map((user) => [user.id, user]));\n  return items.map((item) => ({\n    ...item,\n    createdBy: (\n      /** @type {User} */\n      userMap.get(item.createdByUserId)\n    )\n  }));\n}\nconst q = {\n  includeCreatedBy,\n  breadcrumbs\n};\nexport {\n  q\n};\n"],"names":[],"mappings":"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"}